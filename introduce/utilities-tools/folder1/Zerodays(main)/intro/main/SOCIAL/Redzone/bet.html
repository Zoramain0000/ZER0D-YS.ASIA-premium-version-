<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Advanced Color Betting Game</title>
<style>
* {
    box-sizing: border-box;
  }
  body {
    margin:0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSFVOZ2CsKQIPT0Lk06f5bNALaBIuEhMWppBg&s');
    color: red;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    user-select: none;
    -webkit-font-smoothing: antialiased;
    padding: 2rem;
  }
  .container {
background: rgba(0, 0, 0, 0.5);
    padding: 2rem 3rem;
    border-radius: 12px;
    box-shadow: 0 0 20px rgba(0,0,0,0.7);
    max-width: 480px;
    width: 100%;
    text-align: center;
  }
  h1 {
    margin-bottom: 1rem;
  }
  
  .balance {
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
    font-weight: 700;
  }
  .bet-section {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1rem;
    
  }
  .color-btn {
    flex: 1;
    padding: 1rem;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    font-size: 1.1rem;
    cursor: pointer;
    color: red;
    transition: background-color 0.3s ease, transform 0.15s ease;
    user-select: none;
    box-shadow: 0 4px 6px rgba(0,0,0,0.5);
  }
  .color-btn.:hover{
background: rgba(0, 0, 0, 0.5);
  }
  .color-btn.red {
    background: #e74c3c;
  }
  .color-btn.red:hover {
background: rgba(0, 0, 0, 0.5);
  }
  .color-btn.green {
    background: #27ae60;
  }
  .color-btn.green:hover {
background: rgba(0, 0, 0, 0.5);
  }
  .color-btn.blue {
    background: #2980b9;
  }
  .color-btn.blue:hover {
background: rgba(0, 0, 0, 0.5);
  }
  .color-btn.selected {
    outline: 3px solid #fff;
    box-shadow: 0 0 10px 3px #fff;
  }
  input[type="number"] {
    width: 100%;
    padding: 0.75rem;
    font-size: 1.1rem;
    border-radius: 8px;
    border: none;
    margin-bottom: 1rem;
    text-align: center;
    font-weight: bold;
    outline: none;
background: rgba(0, 0, 0, 0.5);
    color: red;
    box-shadow: inset 0 0 5px #000000aa;
    transition: box-shadow 0.3s ease;
  }
  button.place-bet {
    width: 100%;
    padding: 1rem;
    font-size: 1.2rem;
    font-weight: 700;
    border: none;
    border-radius: 8px;
    background: red;
    color: green;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.15s ease;
    box-shadow: 0 5px 10px red;
  }
  button.place-bet:hover:not(:disabled) {
background: rgba(0, 0, 0, 0.5);
  }
  button.place-bet:disabled {
    background: red;
    cursor: not-allowed;
    box-shadow: none;
  }
  .result {
    margin-top: 1.5rem;
    font-size: 1.3rem;
    min-height: 3rem;
    font-weight: 700;
    opacity: 0;
    transition: opacity 0.5s ease;
  }
  .result.visible {
    opacity: 1;
  }
  .result.win {
    color: green;
  }
  .result.lose {
    color: red;
  }
  .history, .stats {
    margin-top: 2rem;
background: rgba(0, 0, 0, 0.5);
    padding: 1rem;
    border-radius: 8px;
    box-shadow: inset 0 0 10px red;
  }
</style>
</head>
<body>

<div class="container" role="main" aria-label="Advanced Color Betting Game">
  <h1>ðŸŽ² Color Betting Game</h1>
  <div class="balance" aria-live="polite">Balance: $<span id="balance">1000.00</span></div>

  <input
    type="number"
    id="betAmount"
    placeholder="Enter bet amount"
    min="1"
    step="1"
    aria-label="Bet amount"
    value="10"
  />

  <div class="bet-section" role="radiogroup" aria-label="Choose a color to bet on">
    <button class="color-btn red" data-color="red" role="radio" aria-checked="false" tabindex="0">Red</button>
    <button class="color-btn green" data-color="green" role="radio" aria-checked="false" tabindex="-1">Green</button>
    <button class="color-btn blue" data-color="blue" role="radio" aria-checked="false" tabindex="-1">Blue</button>
  </div>

  <button class="place-bet" disabled>Place Bet</button>

  <div class="result" aria-live="polite" id="result"></div>

  <button class="reset" aria-label="Reset balance to 1000">Reset Balance</button>

  <div class="stats" aria-label="Game statistics" aria-live="polite" role="region">
    <h2 style="margin-top: 0;">ðŸ“Š Stats</h2>
    <p><strong>Total Games:</strong> <span id="totalGames">0</span></p>
    <p><strong>Wins:</strong> <span id="wins">0</span></p>
    <p><strong>Losses:</strong> <span id="losses">0</span></p>
    <p><strong>Win Percentage:</strong> <span id="winPercent">0%</span></p>
  </div>

  <div class="history" aria-label="Bet history" tabindex="0"></div>
</div>

<script>
(() => {
  const colors = ['red', 'green', 'blue'];
  let balance = 1000;
  let selectedColor = null;
  let totalGames = 0;
  let wins = 0;
  let losses = 0;

  const balanceEl = document.getElementById('balance');
  const betInput = document.getElementById('betAmount');
  const colorButtons = document.querySelectorAll('.color-btn');
  const placeBetBtn = document.querySelector('button.place-bet');
  const resultEl = document.getElementById('result');
  const resetBtn = document.querySelector('button.reset');
  const historyEl = document.querySelector('.history');
  const totalGamesEl = document.getElementById('totalGames');
  const winsEl = document.getElementById('wins');
  const lossesEl = document.getElementById('losses');
  const winPercentEl = document.getElementById('winPercent');

  function updateBalanceDisplay() {
    balanceEl.textContent = balance.toFixed(2);
  }

  function updateStats() {
    totalGamesEl.textContent = totalGames;
    winsEl.textContent = wins;
    lossesEl.textContent = losses;
    winPercentEl.textContent = totalGames === 0 ? '0%' : ((wins / totalGames) * 100).toFixed(1) + '%';
  }

  function clearSelection() {
    selectedColor = null;
    colorButtons.forEach(btn => {
      btn.classList.remove('selected');
      btn.setAttribute('aria-checked', 'false');
      btn.setAttribute('tabindex', '-1');
    });
    colorButtons[0].setAttribute('tabindex', '0');
  }

  function enablePlaceBetIfValid() {
    const betVal = parseFloat(betInput.value);
    placeBetBtn.disabled = !(selectedColor && betVal > 0 && betVal <= balance);
  }

  // Handle color button click & keyboard navigation
  colorButtons.forEach((btn, index) => {
    btn.addEventListener('click', () => {
      selectColor(btn.dataset.color);
      btn.focus();
    });

    btn.addEventListener('keydown', e => {
      if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
        e.preventDefault();
        let nextIndex = (index + 1) % colorButtons.length;
        colorButtons[nextIndex].focus();
      } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
        e.preventDefault();
        let prevIndex = (index - 1 + colorButtons.length) % colorButtons.length;
        colorButtons[prevIndex].focus();
      } else if (e.key === ' ' || e.key === 'Enter') {
        e.preventDefault();
        selectColor(btn.dataset.color);
      }
    });
  });

  function selectColor(color) {
    selectedColor = color;
    colorButtons.forEach(btn => {
      if (btn.dataset.color === color) {
        btn.classList.add('selected');
        btn.setAttribute('aria-checked', 'true');
        btn.setAttribute('tabindex', '0');
      } else {
        btn.classList.remove('selected');
        btn.setAttribute('aria-checked', 'false');
        btn.setAttribute('tabindex', '-1');
      }
    });
    enablePlaceBetIfValid();
  }

  betInput.addEventListener('input', () => {
    let val = betInput.value;
    // Allow only numbers, max balance
    if (val === '') {
      placeBetBtn.disabled = true;
      return;
    }
    val = Math.min(Number(val), balance);
    if (val < 1) {
      placeBetBtn.disabled = true;
      return;
    }
    betInput.value = val;
    enablePlaceBetIfValid();
  });

  placeBetBtn.addEventListener('click', () => {
    const betAmount = parseFloat(betInput.value);
    if (!selectedColor || isNaN(betAmount) || betAmount <= 0 || betAmount > balance) {
      alert('Invalid bet or no color selected.');
      return;
    }

    // Deduct bet amount first
    balance -= betAmount;

    // Generate winning color randomly
    const winningColor = colors[Math.floor(Math.random() * colors.length)];

    totalGames++;

    let outcomeText = `Winning Color: ${capitalize(winningColor)}. `;

    if (selectedColor === winningColor) {
      // Win
      const winnings = calculateWinnings(betAmount, winningColor);
      balance += winnings;
      wins++;
      outcomeText += `You won $${winnings.toFixed(2)}! ðŸŽ‰`;
      showResult(outcomeText, true);
    } else {
      // Lose
      losses++;
      outcomeText += `You lost $${betAmount.toFixed(2)}. ðŸ˜ž`;
      showResult(outcomeText, false);
    }

    updateBalanceDisplay();
    updateStats();
    addHistoryEntry(selectedColor, winningColor, betAmount, selectedColor === winningColor);

    // Reset bet input and disable button until valid input & selection
    betInput.value = '';
    placeBetBtn.disabled = true;
    clearSelection();
    betInput.focus();
  });

  resetBtn.addEventListener('click', () => {
    balance = 1000;
    totalGames = 0;
    wins = 0;
    losses = 0;
    updateBalanceDisplay();
    updateStats();
    clearResult();
    betInput.value = '';
    placeBetBtn.disabled = true;
    clearSelection();
    historyEl.innerHTML = '';
    betInput.focus();
  });

  function calculateWinnings(amount, color) {
    // Different odds per color
    // Red pays 2x, Green pays 3x, Blue pays 5x
    switch(color) {
      case 'red': return amount * 2;
      case 'green': return amount * 3;
      case 'blue': return amount * 5;
      default: return amount * 2;
    }
  }

  function showResult(text, won) {
    resultEl.textContent = text;
    resultEl.classList.add('visible');
    if (won) {
      resultEl.classList.remove('lose');
      resultEl.classList.add('win');
    } else {
      resultEl.classList.remove('win');
      resultEl.classList.add('lose');
    }
  }

  function clearResult() {
    resultEl.textContent = '';
    resultEl.classList.remove('visible', 'win', 'lose');
  }

  function addHistoryEntry(betColor, winColor, betAmount, didWin) {
    const entry = document.createElement('div');
    entry.className = 'history-entry';
    const now = new Date();
    entry.textContent = `[${now.toLocaleTimeString()}] Bet: ${capitalize(betColor)} $${betAmount.toFixed(2)} â€” Winning Color: ${capitalize(winColor)} â€” ${didWin ? 'Won' : 'Lost'}`;
    if(didWin){
      entry.style.color = 'var(--win)';
    } else {
      entry.style.color = 'var(--lose)';
    }
    historyEl.prepend(entry);
  }

  function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
  }

  // Initialize
  updateBalanceDisplay();
  updateStats();
  clearSelection();
  betInput.focus();

})();
</script>

</body>
</html>
