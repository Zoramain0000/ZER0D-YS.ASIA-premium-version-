<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Watermark Remover</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSFVOZ2CsKQIPT0Lk06f5bNALaBIuEhMWppBg&s');
      color: red;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h1 {
      color: red;
      margin-bottom: 20px;
      text-align: center;
    }
    .container {
      width: 100%;
      max-width: 900px;
background: rgba(0, 0, 0, 0.5);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }
    .upload-area {
      border: 2px dashed red;
      border-radius: 8px;
      padding: 30px;
      text-align: center;
      cursor: pointer;
      margin-bottom: 20px;
      transition: border 0.3s;
    }
    .upload-area:hover {
      border-color: red;
    }
    .upload-area p {
      margin-top: 10px;
      color: #aaa;
    }
    #fileInput {
      display: none;
    }
    .canvas-container {
      position: relative;
      margin: 20px 0;
      display: none;
    }
    #canvas {
      max-width: 100%;
      border-radius: 8px;
      display: block;
      margin: 0 auto;
    }
    .toolbar {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .btn {
      padding: 10px 15px;
      background: red;
      color: green;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.2s;
    }
    .btn:hover {
background: rgba(0, 0, 0, 0.5);
    }
    .btn:disabled {
background: rgba(0, 0, 0, 0.5);
      cursor: not-allowed;
    }
    .eraser-controls {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }
    .eraser-controls label {
      color: red;
    }
    #eraserSize {
      width: 100px;
    }
    .instructions {
      margin-top: 20px;
      color: red;
      font-size: 0.9em;
      text-align: center;
    }
    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }
      .toolbar {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <h1>üîç Advanced Watermark Remover</h1>
  <div class="container">
    <div class="upload-area" id="uploadArea">
      <p>üìÅ Drag & drop an image or click to browse</p>
      <input type="file" id="fileInput" accept="image/*" />
    </div>
    <div class="canvas-container" id="canvasContainer">
      <canvas id="canvas"></canvas>
    </div>
    <div class="toolbar">
      <button class="btn" id="detectBtn" disabled>Detect Watermark</button>
      <button class="btn" id="eraserBtn" disabled>Eraser Tool</button>
      <button class="btn" id="downloadBtn" disabled>Download Image</button>
      <button class="btn" id="resetBtn" disabled>Reset</button>
    </div>
    <div class="eraser-controls" id="eraserControls" style="display: none;">
      <label for="eraserSize">Eraser Size:</label>
      <input type="range" id="eraserSize" min="5" max="50" value="15">
    </div>
    <p class="instructions">
      <strong>How to use:</strong> Upload an image ‚Üí Detect watermark ‚Üí Use the eraser tool to remove it ‚Üí Download the cleaned image.
    </p>
  </div>

  <script>
    // DOM Elements
    const uploadArea = document.getElementById('uploadArea');
    const fileInput = document.getElementById('fileInput');
    const canvasContainer = document.getElementById('canvasContainer');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const detectBtn = document.getElementById('detectBtn');
    const eraserBtn = document.getElementById('eraserBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const resetBtn = document.getElementById('resetBtn');
    const eraserControls = document.getElementById('eraserControls');
    const eraserSizeInput = document.getElementById('eraserSize');

    // Variables
    let originalImage = null;
    let isErasing = false;
    let eraserSize = 15;

    // Event Listeners
    uploadArea.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', handleImageUpload);
    detectBtn.addEventListener('click', detectWatermark);
    eraserBtn.addEventListener('click', toggleEraser);
    downloadBtn.addEventListener('click', downloadImage);
    resetBtn.addEventListener('click', resetCanvas);
    eraserSizeInput.addEventListener('input', (e) => {
      eraserSize = parseInt(e.target.value);
    });

    // Drag & Drop
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.style.borderColor = '#8ab4f8';
    });
    uploadArea.addEventListener('dragleave', () => {
      uploadArea.style.borderColor = '#555';
    });
    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.style.borderColor = '#555';
      if (e.dataTransfer.files.length) {
        fileInput.files = e.dataTransfer.files;
        handleImageUpload();
      }
    });

    // Handle Image Upload
    function handleImageUpload() {
      const file = fileInput.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = (e) => {
        originalImage = new Image();
        originalImage.onload = () => {
          canvas.width = originalImage.width;
          canvas.height = originalImage.height;
          ctx.drawImage(originalImage, 0, 0);
          canvasContainer.style.display = 'block';
          detectBtn.disabled = false;
          resetBtn.disabled = false;
        };
        originalImage.src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    // Detect Watermark (Simple edge detection)
    function detectWatermark() {
      if (!originalImage) return;

      // Convert to grayscale and apply edge detection
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const data = imageData.data;

      for (let i = 0; i < data.length; i += 4) {
        const r = data[i];
        const g = data[i + 1];
        const b = data[i + 2];
        const avg = (r + g + b) / 3;

        // Highlight edges (simple threshold)
        if (avg > 200 || avg < 50) {
          data[i] = 255;     // R
          data[i + 1] = 0;   // G
          data[i + 2] = 0;   // B
        }
      }

      ctx.putImageData(imageData, 0, 0);
      eraserBtn.disabled = false;
      downloadBtn.disabled = false;
    }

    // Toggle Eraser Tool
    function toggleEraser() {
      isErasing = !isErasing;
      eraserControls.style.display = isErasing ? 'flex' : 'none';
      eraserBtn.style.background = isErasing ? '#5a90f0' : '#8ab4f8';

      if (isErasing) {
        canvas.style.cursor = 'crosshair';
        canvas.addEventListener('mousemove', eraseWatermark);
        canvas.addEventListener('mousedown', eraseWatermark);
      } else {
        canvas.stylecanvas.style.cursor = 'default';
        canvas.removeEventListener('mousemove', eraseWatermark);
        canvas.removeEventListener('mousedown', eraseWatermark);
      }
    }

    // Erase Watermark
    function eraseWatermark(e) {
      if (!isErasing) return;

      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      ctx.globalCompositeOperation = 'destination-out';
      ctx.beginPath();
      ctx.arc(x, y, eraserSize, 0, Math.PI * 2);
      ctx.fill();
      ctx.globalCompositeOperation = 'source-over';
    }

    // Download Image
    function downloadImage() {
      const link = document.createElement('a');
      link.download = 'watermark_removed.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    }

    // Reset Canvas
    function resetCanvas() {
      if (!originalImage) return;
      ctx.drawImage(originalImage, 0, 0);
      isErasing = false;
      eraserControls.style.display = 'none';
      eraserBtn.style.background = '#8ab4f8';
      canvas.style.cursor = 'default';
      canvas.removeEventListener('mousemove', eraseWatermark);
      canvas.removeEventListener('mousedown', eraseWatermark);
    }
  </script>
</body>
</html>
