<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>YouTube Thumbnail Downloader - Batch & Preview</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSFVOZ2CsKQIPT0Lk06f5bNALaBIuEhMWppBg&s');
    color: red;
    margin: 0;
    padding: 20px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 {
    color: red;
    margin-bottom: 15px;
    user-select: none;
  }
  .container {
background: rgba(0, 0, 0, 0.5)
    border-radius: 10px;
    padding: 25px;
    width: 100%;
    max-width: 800px;
    box-shadow: 0 0 15px red;
  }
  textarea {
    width: 100%;
    height: 120px;
    padding: 12px;
    font-size: 1rem;
    border-radius: 8px;
    border: none;
background: rgba(0, 0, 0, 0.5)
    color: red;
    resize: vertical;
    font-family: monospace;
  }
  button {
    background: red;
    border: none;
    padding: 14px 25px;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    color: green;
    margin-top: 15px;
    width: 100%;
    font-size: 1.15rem;
    transition: background 0.3s ease;
  }
  button:hover {
background: rgba(0, 0, 0, 0.5)
  }
  .error {
    color: red;
    margin-top: 10px;
    font-weight: bold;
    min-height: 1.4em;
  }
  .thumbnails {
    margin-top: 30px;
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(160px,1fr));
    gap: 20px;
  }
  .thumb-card {
    background: red;
    border-radius: 8px;
    padding: 12px;
    text-align: center;
    cursor: pointer;
    transition: background 0.2s ease;
  }
  .thumb-card:hover {
background: rgba(0, 0, 0, 0.5)
  }
  .thumb-card img {
    width: 100%;
    border-radius: 6px;
    user-select: none;
  }
  .thumb-card p {
    margin: 10px 0 0;
    font-weight: 600;
    font-size: 0.9rem;
    user-select: none;
    color: red;
  }

  /* Modal Styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 99999;
    padding-top: 60px;
    left: 0;
    top: 0;
    width: 100vw;
    height: 100vh;
    overflow: auto;
    background-color: rgba(0,0,0,0.85);
  }
  .modal-content {
    margin: auto;
background: rgba(0, 0, 0, 0.5)
    border-radius: 12px;
    padding: 20px;
    max-width: 700px;
    text-align: center;
    position: relative;
    color: red;
  }
  .modal-content img {
    max-width: 100%;
    border-radius: 8px;
  }
  .close-btn {
    color: red;
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    user-select: none;
  }
  .close-btn:hover {
background: rgba(0, 0, 0, 0.5)
  }
  .download-btn {
    margin-top: 15px;
    background: red;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    font-weight: bold;
    color: green;
    cursor: pointer;
    font-size: 1rem;
    transition: background 0.3s ease;
  }
  .download-btn:hover {
background: rgba(0, 0, 0, 0.5)
  }
  @media(max-width: 480px) {
    .thumbnails {
      grid-template-columns: repeat(auto-fill,minmax(120px,1fr));
    }
  }
</style>
</head>
<body>

<h1>YouTube Thumbnail Downloader</h1>

<div class="container">
  <textarea id="videoUrls" placeholder="Enter YouTube video URLs or IDs (one per line)"></textarea>
  <button onclick="processBatch()">Get Thumbnails</button>
  <div id="error" class="error"></div>
  <div id="thumbnails" class="thumbnails"></div>
</div>

<!-- Modal for preview -->
<div id="previewModal" class="modal" onclick="closeModal(event)">
  <div class="modal-content">
    <span class="close-btn" onclick="closeModal(event)">&times;</span>
    <img id="modalImg" src="" alt="Thumbnail Preview" />
    <br />
    <button id="downloadBtn" class="download-btn">Download</button>
  </div>
</div>

<script>
  // Extract video ID from various YouTube URL formats or just validate ID
  function extractVideoID(url) {
    url = url.trim();
    const regex = /(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:watch\?v=|embed\/|v\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
    const match = url.match(regex);
    if (match && match[1]) return match[1];
    if (/^[a-zA-Z0-9_-]{11}$/.test(url)) return url;
    return null;
  }

  const sizes = [
    { label: "Default (120x90)", path: "default.jpg" },
    { label: "Medium (320x180)", path: "mqdefault.jpg" },
    { label: "High (480x360)", path: "hqdefault.jpg" },
    { label: "Standard (640x480)", path: "sddefault.jpg" },
    { label: "Max Resolution", path: "maxresdefault.jpg" },
  ];

  function processBatch() {
    const input = document.getElementById('videoUrls').value;
    const errorDiv = document.getElementById('error');
    const thumbsDiv = document.getElementById('thumbnails');
    errorDiv.textContent = '';
    thumbsDiv.innerHTML = '';

    if (!input.trim()) {
      errorDiv.textContent = '❌ Please enter at least one YouTube URL or video ID.';
      return;
    }

    // Split input lines, filter out empty lines
    const lines = input.split('\n').map(line => line.trim()).filter(Boolean);

    let anyInvalid = false;

    lines.forEach((line, idx) => {
      const videoID = extractVideoID(line);
      if (!videoID) {
        anyInvalid = true;
        thumbsDiv.insertAdjacentHTML('beforeend', 
          `<div class="thumb-card" style="background:#550000; color:#faa; cursor:default;">
            <p>Invalid ID/URL: ${line}</p>
          </div>`);
        return;
      }

      sizes.forEach(({label, path}) => {
        const url = `https://img.youtube.com/vi/${videoID}/${path}`;
        const card = document.createElement('div');
        card.className = 'thumb-card';
        card.title = `Click to preview & download\nVideo ID: ${videoID}\nSize: ${label}`;

        const img = document.createElement('img');
        img.src = url;
        img.alt = `${label} thumbnail`;
        img.loading = 'lazy';

        const caption = document.createElement('p');
        caption.textContent = label;

        card.appendChild(img);
        card.appendChild(caption);

        card.onclick = () => openModal(url, videoID, label);

        thumbsDiv.appendChild(card);
      });
    });

    if (anyInvalid) {
      errorDiv.textContent = '⚠️ Some inputs were invalid and skipped.';
    }
  }

  // Modal logic
  const modal = document.getElementById('previewModal');
  const modalImg = document.getElementById('modalImg');
  const downloadBtn = document.getElementById('downloadBtn');

  function openModal(imgUrl, videoID, sizeLabel) {
    modal.style.display = 'block';
    modalImg.src = imgUrl;
    downloadBtn.onclick = () => {
      const a = document.createElement('a');
      a.href = imgUrl;
      a.download = `${videoID}_${sizeLabel.replace(/[^a-z0-9]/gi, '_').toLowerCase()}.jpg`;
      document.body.appendChild(a);
      a.click();
      a.remove();
    };
  }

  function closeModal(e) {
    if (e.target === modal || e.target.classList.contains('close-btn')) {
      modal.style.display = 'none';
      modalImg.src = '';
    }
  }

  // Close modal on ESC key
  document.addEventListener('keydown', e => {
    if (e.key === 'Escape' && modal.style.display === 'block') {
      modal.style.display = 'none';
      modalImg.src = '';
    }
  });
</script>

</body>
</html>
