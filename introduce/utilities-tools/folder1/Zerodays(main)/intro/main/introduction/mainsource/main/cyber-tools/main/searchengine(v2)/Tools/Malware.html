<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Malware Scan Tool</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      margin: 0;
      background: #f4f4f4;
      color: #333;
    }
    .dark-mode {
      background: #0f0f0f;
      color: #00ff00;
    }
    .container {
      max-width: 900px;
      margin: 40px auto;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    textarea, input[type="text"], input[type="file"] {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 1px solid #ccc;
      margin-bottom: 12px;
      border-radius: 6px;
    }
    button {
      background-color: #3498db;
      color: #fff;
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background-color: #2980b9;
    }
    .terminal {
      background: #000;
      color: #00ff00;
      padding: 20px;
      height: 300px;
      overflow-y: auto;
      font-family: monospace;
      border-radius: 6px;
      white-space: pre-wrap;
    }
    .chart-container {
      max-width: 500px;
      margin: 30px auto;
      display: none;
    }
    .toggle {
      float: right;
      margin-top: -40px;
    }
    .btn-group {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 15px;
    }
    .dropzone {
      border: 2px dashed #bbb;
      padding: 20px;
      text-align: center;
      margin-bottom: 15px;
      border-radius: 6px;
      background: #fff;
      transition: background 0.2s;
    }
    .dropzone.dragover {
      background: #eef;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>AI Malware Scanner</h1>

    <div class="toggle">
      <label><input type="checkbox" id="modeToggle"> Dark Mode</label>
    </div>

    <input type="text" id="scanInput" placeholder="Enter URL, file hash or file name">
    <input type="file" id="fileInput">

    <div class="dropzone" id="dropzone">Drag & Drop file here</div>

    <div class="btn-group">
      <button onclick="startScan()">Start Scan</button>
      <button onclick="exportResults('txt')">Export TXT</button>
      <button onclick="exportResults('csv')">Export CSV</button>
      <button onclick="exportResults('json')">Export JSON</button>
    </div>

    <div class="terminal" id="terminal"></div>

    <div class="chart-container">
      <canvas id="scanChart"></canvas>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const sleep = ms => new Promise(resolve => setTimeout(resolve, ms));
    let scanOutput = '';
    let scanData = {};

    document.getElementById("modeToggle").addEventListener("change", function () {
      document.body.classList.toggle("dark-mode");
    });

    const dropzone = document.getElementById("dropzone");
    dropzone.addEventListener("dragover", e => {
      e.preventDefault();
      dropzone.classList.add("dragover");
    });
    dropzone.addEventListener("dragleave", () => {
      dropzone.classList.remove("dragover");
    });
    dropzone.addEventListener("drop", e => {
      e.preventDefault();
      dropzone.classList.remove("dragover");
      document.getElementById("fileInput").files = e.dataTransfer.files;
    });

    async function startScan() {
      const input = document.getElementById('scanInput').value.trim();
      const file = document.getElementById('fileInput').files[0];
      const terminal = document.getElementById('terminal');
      const chartContainer = document.querySelector('.chart-container');
      terminal.innerHTML = '';
      chartContainer.style.display = 'none';
      scanOutput = '';
      scanData = {};

      if (!input && !file) {
        await appendLine("Error: No input or file provided.");
        return;
      }

      const name = input || (file ? file.name : 'Unknown');
      await appendLine("Initializing AI Malware Scan...");
      await appendLine("Analyzing input: " + name);
      await sleep(500);

      if (file) {
        await appendLine("Uploading and analyzing file: " + file.name);
        await sleep(700);
        // You can insert real signature scanning logic here.
        // For now, simulate pattern matching or heuristics.
      }

      await appendLine("Checking multiple engines (VirusTotal, Hybrid Analysis, urlscan.io)...");
      await sleep(700);

      const malicious = Math.floor(Math.random() * 10);
      const undetected = Math.floor(Math.random() * 50 + 10);
      const suspicious = Math.floor(Math.random() * 5);

      scanData = { name, malicious, undetected, suspicious };

      await appendLine(`Result Summary:`);
      await appendLine(`- Malicious: ${malicious}`);
      await appendLine(`- Undetected: ${undetected}`);
      await appendLine(`- Suspicious: ${suspicious}`);

      drawChart(malicious, undetected, suspicious);
    }

    async function appendLine(line) {
      const terminal = document.getElementById('terminal');
      terminal.innerHTML += line + '\n';
      scanOutput += line + '\n';
      terminal.scrollTop = terminal.scrollHeight;
      await sleep(80 + Math.random() * 100);
    }

    function drawChart(malicious, undetected, suspicious) {
      const ctx = document.getElementById('scanChart').getContext('2d');
      document.querySelector('.chart-container').style.display = 'block';

      if (window.myChart) window.myChart.destroy();

      window.myChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['Malicious', 'Undetected', 'Suspicious'],
          datasets: [{
            data: [malicious, undetected, suspicious],
            backgroundColor: ['#e74c3c', '#2ecc71', '#f1c40f'],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { position: 'bottom' }
          }
        }
      });
    }

    function exportResults(format = 'txt') {
      if (!scanOutput) {
        alert("No scan results to export.");
        return;
      }

      let blob, filename;

      switch (format) {
        case 'csv':
          const csv = `Name,Malicious,Undetected,Suspicious\n${scanData.name},${scanData.malicious},${scanData.undetected},${scanData.suspicious}`;
          blob = new Blob([csv], { type: 'text/csv' });
          filename = 'malware_scan_results.csv';
          break;
        case 'json':
          blob = new Blob([JSON.stringify(scanData, null, 2)], { type: 'application/json' });
          filename = 'malware_scan_results.json';
          break;
        case 'txt':
        default:
          blob = new Blob([scanOutput], { type: 'text/plain' });
          filename = 'malware_scan_results.txt';
      }

      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = filename;
      link.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
