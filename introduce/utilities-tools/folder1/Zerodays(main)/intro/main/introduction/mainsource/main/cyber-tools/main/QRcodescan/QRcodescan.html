<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QR Code Scanner Pro</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSFVOZ2CsKQIPT0Lk06f5bNALaBIuEhMWppBg&s'); 
      color: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      transition: background 0.3s ease;
    }

    body.dark {
      background-color: #121212;
      color: #f1f1f1;
    }

    .container {
      background-color: #fff;
      border-radius: 12px;
      width: 450px;
      padding: 30px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .container.dark {
      background-color: #1e1e1e;
    }

    .title {
      font-size: 24px;
      font-weight: 600;
      color: green;
      margin-bottom: 20px;
    }

    .title.dark {
      color: green;
    }

    .drop-area {
      background: red;
      border-radius: 8px;
      padding: 30px;
      margin-bottom: 20px;
      cursor: pointer;
      transition: background 0.2s ease;
      color: green;
      font-size: 16px;
      border: 2px dashed green;
    }

    .drop-area.dragover {
      background: green;
    }

    .drop-area i {
      font-size: 50px;
    }

    .preview {
      display: none;
      margin-top: 15px;
      max-height: 150px;
      width: 100%;
      border-radius: 10px;
    }

    .status {
      font-size: 16px;
      color: #28a745;
      margin-top: 15px;
      display: none;
    }

    .status.error {
      color: #dc3545;
    }

    .output-box {
      margin-top: 20px;
      font-size: 16px;
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid red;
      background-color: white;
      resize: none;
    }

    .output-box.dark {
      background-color: green;
      color: red;
    }

    .buttons {
      margin-top: 20px;
      display: flex;
      gap: 15px;
      justify-content: space-between;
    }

    .buttons button {
      flex: 1;
      padding: 12px;
      border: none;
      background: red;
      color: green;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.3s;
    }

    .buttons button:hover {
      background: green;
    }

    .toggle-mode {
      margin-top: 20px;
      font-size: 14px;
      color: #0B85FF;
      cursor: pointer;
      font-weight: bold;
    }

    .toggle-mode:hover {
      color: #1c71d6;
    }

    video {
      display: none;
      margin-top: 15px;
      width: 100%;
      border-radius: 6px;
    }

    .wrapper.active video {
      display: block;
    }

    @media (max-width: 480px) {
      .container {
        width: 90%;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <div class="title" >QR Code Scanner</div>

  <div class="drop-area" id="drop-area">
    <input type="file" hidden id="file-input" accept="image/*" />
    <i class="fas fa-cloud-upload-alt"></i>
    <p>Click or Drag QR Image Here</p>
    <img src="" class="preview" alt="QR Preview" />
  </div>

  <div class="status" id="status-message">QR Code Scanned!</div>

  <textarea class="output-box" readonly id="output" placeholder="Scanned text will appear here..."></textarea>

  <div class="buttons">
    <!-- Removed the download button -->
    <button onclick="clearAll()">Clear</button>
  </div>

  <div class="toggle-mode" onclick="toggleMode()">ðŸŒ— Toggle Dark Mode</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
<script>
  const wrapper = document.querySelector(".container");
  const dropArea = document.getElementById("drop-area");
  const fileInput = document.getElementById("file-input");
  const previewImg = document.querySelector(".preview");
  const output = document.getElementById("output");
  const statusMessage = document.getElementById("status-message");

  let stream, autoCopy = true;
  let lastQRData = '';
  let lastImageDataURL = '';

  const beep = new Audio("https://www.soundjay.com/buttons/sounds/beep-07.mp3");

  dropArea.addEventListener("click", () => fileInput.click());
  fileInput.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (file) processFile(file);
  });

  dropArea.addEventListener("dragover", (e) => {
    e.preventDefault();
    dropArea.classList.add("dragover");
  });

  dropArea.addEventListener("dragleave", () => dropArea.classList.remove("dragover"));

  dropArea.addEventListener("drop", (e) => {
    e.preventDefault();
    dropArea.classList.remove("dragover");
    const file = e.dataTransfer.files[0];
    if (file) processFile(file);
  });

  function processFile(file) {
    const reader = new FileReader();
    reader.onload = () => {
      const img = new Image();
      img.onload = () => {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = img.width;
        canvas.height = img.height;
        ctx.drawImage(img, 0, 0);
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const code = jsQR(imageData.data, canvas.width, canvas.height);
        if (code) {
          beep.play();
          output.value = code.data;
          lastQRData = code.data;
          lastImageDataURL = reader.result;
          previewImg.src = reader.result;
          wrapper.classList.add("active");
          saveToHistory(code.data);
          statusMessage.textContent = "QR Code Scanned Successfully!";
          statusMessage.classList.remove('error');
          statusMessage.classList.add('success');
          statusMessage.style.display = 'block';
          if (autoCopy) navigator.clipboard.writeText(code.data);
        } else {
          alert("No QR code detected.");
          statusMessage.textContent = "Error: No QR code detected!";
          statusMessage.classList.add('error');
          statusMessage.style.display = 'block';
        }
      };
      img.src = reader.result;
    };
    reader.readAsDataURL(file);
  }

  function clearAll() {
    output.value = "";
    lastQRData = "";
    lastImageDataURL = "";
    previewImg.src = "";
    wrapper.classList.remove("active");
    statusMessage.style.display = 'none';
  }

  function toggleMode() {
    document.body.classList.toggle("dark");
    wrapper.classList.toggle("dark");
  }

  function saveToHistory(text) {
    let history = JSON.parse(localStorage.getItem("qrHistory") || "[]");
    history.unshift({ text, time: new Date().toLocaleString() });
    if (history.length > 10) history.pop();
    localStorage.setItem("qrHistory", JSON.stringify(history));
  }
</script>

</body>
</html>
