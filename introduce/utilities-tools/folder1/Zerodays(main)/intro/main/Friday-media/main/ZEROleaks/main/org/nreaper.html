<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Advanced HTTP Request Inspector</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 0; background: #1e1e1e; color: #ddd;
    display: flex; flex-direction: column; min-height: 100vh;
  }
  header {
    background: #007acc;
    padding: 1rem;
    text-align: center;
    font-size: 1.5rem;
    font-weight: bold;
    color: white;
  }
  main {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 1rem;
    max-width: 900px;
    margin: auto;
    width: 100%;
  }
  label {
    margin-top: 1rem;
    font-weight: 600;
  }
  input[type="text"], select, textarea {
    width: 100%;
    padding: 0.5rem;
    margin-top: 0.3rem;
    border-radius: 4px;
    border: none;
    font-family: monospace;
    font-size: 1rem;
    background: #2d2d2d;
    color: #eee;
  }
  textarea {
    resize: vertical;
    min-height: 100px;
  }
  button {
    margin-top: 1rem;
    padding: 0.7rem 1.2rem;
    background: #007acc;
    border: none;
    border-radius: 4px;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  button:hover {
    background: #005f99;
  }
  .response-section {
    margin-top: 2rem;
    background: #2d2d2d;
    border-radius: 6px;
    padding: 1rem;
    overflow-x: auto;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-family: monospace;
    font-size: 0.9rem;
  }
  .header-list {
    margin: 0;
    padding: 0;
    list-style: none;
  }
  .header-list li {
    padding: 0.2rem 0;
    border-bottom: 1px solid #444;
  }
  .flex-row {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }
  .flex-row > * {
    flex: 1 1 200px;
  }
  .small-input {
    width: 80px;
  }
  .headers-input {
    margin-top: 0.5rem;
    font-family: monospace;
    font-size: 0.9rem;
    height: 80px;
  }
  .status {
    font-weight: 700;
    margin-bottom: 0.5rem;
  }
  .error {
    color: #ff5555;
  }
  .success {
    color: #55ff55;
  }
</style>
</head>
<body>
<header>Advanced HTTP Request Inspector</header>
<main>
  <label for="url">Request URL</label>
  <input type="text" id="url" placeholder="https://api.example.com/data" />

  <div class="flex-row">
    <div>
      <label for="method">HTTP Method</label>
      <select id="method">
        <option>GET</option>
        <option>POST</option>
        <option>PUT</option>
        <option>DELETE</option>
        <option>PATCH</option>
        <option>HEAD</option>
        <option>OPTIONS</option>
      </select>
    </div>
    <div>
      <label for="timeout">Timeout (ms)</label>
      <input type="number" id="timeout" class="small-input" value="10000" min="1000" />
    </div>
  </div>

  <label for="headers">Request Headers (one per line, format: Key: Value)</label>
  <textarea id="headers" class="headers-input" placeholder="Content-Type: application/json&#10;Authorization: Bearer token"></textarea>

  <label for="body">Request Body (for POST, PUT, PATCH)</label>
  <textarea id="body" placeholder='{"key":"value"}'></textarea>

  <button id="sendBtn">Send Request</button>

  <section class="response-section" id="responseSection" style="display:none;">
    <div class="status" id="statusLine"></div>
    <div>
      <strong>Response Headers:</strong>
      <ul class="header-list" id="responseHeaders"></ul>
    </div>
    <div style="margin-top:1rem;">
      <strong>Response Body:</strong>
      <pre id="responseBody"></pre>
    </div>
  </section>
</main>

<script>
  const sendBtn = document.getElementById('sendBtn');
  const urlInput = document.getElementById('url');
  const methodSelect = document.getElementById('method');
  const headersInput = document.getElementById('headers');
  const bodyInput = document.getElementById('body');
  const responseSection = document.getElementById('responseSection');
  const statusLine = document.getElementById('statusLine');
  const responseHeaders = document.getElementById('responseHeaders');
  const responseBody = document.getElementById('responseBody');
  const timeoutInput = document.getElementById('timeout');

  function parseHeaders(rawHeaders) {
    const headers = {};
    rawHeaders.trim().split(/[\r\n]+/).forEach(line => {
      const parts = line.split(': ');
      const key = parts.shift();
      const value = parts.join(': ');
      if (key) headers[key] = value;
    });
    return headers;
  }

  function parseRequestHeaders(text) {
    const headers = new Headers();
    const lines = text.split('\n');
    for (let line of lines) {
      line = line.trim();
      if (!line) continue;
      const idx = line.indexOf(':');
      if (idx === -1) continue;
      const key = line.substring(0, idx).trim();
      const value = line.substring(idx + 1).trim();
      if (key && value) {
        headers.append(key, value);
      }
    }
    return headers;
  }

  function displayResponseHeaders(headers) {
    responseHeaders.innerHTML = '';
    for (const [key, value] of headers.entries()) {
      const li = document.createElement('li');
      li.textContent = `${key}: ${value}`;
      responseHeaders.appendChild(li);
    }
  }

  function prettyPrintBody(body, contentType) {
    if (!body) return '';
    if (contentType && contentType.includes('application/json')) {
      try {
        const json = JSON.parse(body);
        return JSON.stringify(json, null, 2);
      } catch {
        return body;
      }
    }
    if (contentType && (contentType.includes('text/html') || contentType.includes('xml'))) {
      // Simple formatting for XML/HTML
      return body.replace(/></g, '>\n<');
    }
    return body;
  }

  sendBtn.addEventListener('click', async () => {
    const url = urlInput.value.trim();
    if (!url) {
      alert('Please enter a valid URL');
      return;
    }
    const method = methodSelect.value;
    const timeout = parseInt(timeoutInput.value, 10) || 10000;
    const headers = parseRequestHeaders(headersInput.value);
    let body = bodyInput.value;

    if (['GET', 'HEAD', 'OPTIONS'].includes(method)) {
      body = null; // No body for these methods
    }

    responseSection.style.display = 'none';
    statusLine.textContent = 'Sending request...';
    responseHeaders.innerHTML = '';
    responseBody.textContent = '';

    try {
      const controller = new AbortController();
      const id = setTimeout(() => controller.abort(), timeout);

      const response = await fetch(url, {
        method,
        headers,
        body,
        signal: controller.signal,
      });
      clearTimeout(id);

      statusLine.textContent = `Status: ${response.status} ${response.statusText}`;
      statusLine.className = response.ok ? 'status success' : 'status error';

      displayResponseHeaders(response.headers);

      const contentType = response.headers.get('content-type') || '';
      let text = await response.text();
      responseBody.textContent = prettyPrintBody(text, contentType);

      responseSection.style.display = 'block';
    } catch (error) {
      statusLine.textContent = `Error: ${error.message}`;
      statusLine.className = 'status error';
      responseSection.style.display = 'block';
    }
  });
</script>
</body>
</html>
