 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Tangled OSINT</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://dns.google">
  <link rel="preconnect" href="https://ipwho.is">
  <link rel="preconnect" href="https://web.archive.org">
  <link rel="preconnect" href="https://r.jina.ai">
<style>
  html,body{
    height:100%;
    margin:0;
    background:transparent;
    color:#c58b00;
    font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  }

  a{color:#c58b00;text-decoration:none;border-bottom:1px dotted #7a5700}
  a:hover{color:#ffda73}

  .wrap{
    max-width:1200px;
    margin:0 auto;
    padding:14px;
    position:relative;
    z-index:1;
    border:1px solid #c58b00;
    border-radius:10px;
    background:rgba(0,0,0,0.5);
  }

  h1{font-size:20px;margin:10px 0;color:#ffc14d}

  .row{display:flex;flex-wrap:wrap;gap:10px}

  .controls,.legend,.quick{
    background:rgba(0,0,0,0.5);
    padding:10px;
    border-radius:8px;
    border:1px solid #c58b00;
  }

  input,button,select{
    background:#000;
    color:red;
    border:1px solid #c58b00;
    border-radius:8px;
    padding:8px 10px;
    font-size:14px;
  }

  button{cursor:pointer}
  button.primary{background:#c58b00;color:#000;border-color:#c58b00}
  button.ghost{background:#000;color:#c58b00;border:1px solid #c58b00}

  .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;margin-top:10px}

  .card{
    background:rgba(0,0,0,0.5);
    border:1px solid #c58b00;
    border-radius:10px;
    padding:10px;
    min-height:110px;
  }

  .card h3{margin:0 0 8px 0;font-size:14px;color:#ffda73}

  .mono{white-space:pre-wrap;word-break:break-word}

  .pill{
    display:inline-block;
    padding:2px 8px;
    border:1px solid #c58b00;
    border-radius:999px;
    margin:2px;
    font-size:12px;
    background:#000;
    color:#c58b00;
  }

  .ok{color:#ffe08a}
  .warn{color:#ffb300}
  .bad{color:#ff4d4d}
  .small{font-size:12px;color:#e0b766}

  .footer{opacity:.7;margin-top:8px}

  .progress{
    height:6px;
    background:#000;
    border-radius:6px;
    overflow:hidden
  }
  .bar{
    height:100%;
    width:0;
    background:linear-gradient(90deg,#c58b00,#ffda73);
    transition:width .2s
  }

  .two{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  @media (max-width:900px){.grid{grid-template-columns:1fr}.two{grid-template-columns:1fr}}

  .kbd{
    border:1px solid #c58b00;
    border-radius:4px;
    padding:1px 6px;
    background:#000;
    color:#c58b00;
  }

  .chips{display:flex;flex-wrap:wrap;gap:6px}
  .chip{cursor:pointer;color:#c58b00;border:1px solid #c58b00;border-radius:8px;padding:2px 6px;background:#0b0b0b}
  .chip.active{background:#c58b00;color:#000;border-color:#c58b00}

  .muted{color:#bfa05a}

  /* Background Video */
  #bg-video{
    position:fixed;top:0;left:0;width:100%;height:100%;
    object-fit:cover;z-index:-1;opacity:0.3;
  }

  /* Music Controls */
  #music-control{
    position:fixed;
    bottom:20px;right:20px;
    background:rgba(0,0,0,0.3);
    border:1px solid #c58b00;
    padding:8px;
    border-radius:50%;
    cursor:pointer;
    z-index:2;
    color:#c58b00;
  }
</style>

</head>
<body>
  <!-- Background Video -->
  <video id="bg-video" autoplay loop muted>
    <source src="background/1761817527453041720p.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>

  <!-- Background Music (autoplay disabled) -->
  <audio id="bg-music" loop>
    <source src="background/Programming___Coding___Hacking_music_vol.18__ANONYMOUS_HEADQUARTERS_(48k).mp3" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <!-- Music Toggle Button -->
  <div id="music-control" title="Toggle Music">üéµ</div>

  <div class="wrap">
    <h1>üï∏Ô∏è Tangled OSINT</h1>

    <div class="controls row">
      <input id="domain" type="text" placeholder="domain.tld" value="tangled.com" style="min-width:240px" />
      <select id="wordlistSel" title="Subdomain list size">
        <option value="tiny">Subdomain list: Tiny (220)</option>
        <option value="small" selected>Small (220)</option>
        <option value="medium">Medium (400)</option>
      </select>
      <input id="limit" type="number" min="10" max="2000" value="500" title="Max subdomains to try" style="width:130px" />
      <button class="primary" id="scanBtn">‚ñ∂Ô∏é Run OSINT</button>
      <button class="ghost" id="cancelBtn">‚èπ Cancel</button>
      <button id="exportImg">üñº Export PNG</button>
      <button id="exportJson">üì¶ Export JSON</button>
      <span class="small">No servers. CORS-safe APIs only; everything else is deep-linked.</span>
    </div>

    <div class="legend quick" id="quickLinks">
      <div class="chips">
        <span class="pill chip" data-open="https://www.shodan.io/search?query=hostname%3A{d}">Shodan</span>
        <span class="pill chip" data-open="https://search.censys.io/search?resource=hosts&q={d}">Censys</span>
        <span class="pill chip" data-open="https://urlscan.io/search/#domain:{d}">urlscan</span>
        <span class="pill chip" data-open="https://crt.sh/?q=%25.{d}">crt.sh</span>
        <span class="pill chip" data-open="https://securitytrails.com/domain/{d}">SecurityTrails</span>
        <span class="pill chip" data-open="https://www.virustotal.com/gui/domain/{d}">VirusTotal</span>
        <span class="pill chip" data-open="https://web.archive.org/web/*/{d}">Wayback</span>
        <span class="pill chip" data-open="https://commoncrawl.org/2023/10/index-to-warc-files-and-urls-in-columnar-format/">CommonCrawl</span>
        <span class="pill chip" data-open="https://builtwith.com/{d}">BuiltWith</span>
        <span class="pill chip" data-open="https://hunter.io/try/{d}">Hunter</span>
        <span class="pill chip" data-open="https://www.google.com/search?q=site%3A{d}+filetype%3Apdf">Google dorks (PDF)</span>
        <span class="pill chip" data-open="https://github.com/search?q={d}&type=code">GitHub code</span>
      </div>
    </div>

    <div class="progress"><div class="bar" id="bar"></div></div>

    <div class="grid">
      <div class="card"><h3>üîé Summary</h3><div id="summary" class="mono small">‚Äî</div></div>
      <div class="card"><h3>üåê DNS (A/AAAA/MX/NS/TXT)</h3><div id="dns" class="mono">‚Äî</div></div>
      <div class="card"><h3>üß≠ IP & Geo</h3><div id="geo" class="mono">‚Äî</div></div>
      <div class="card"><h3>ü™™ SPF / DMARC</h3><div id="email" class="mono">‚Äî</div></div>
      <div class="card"><h3>üß© Subdomains (DoH scan)</h3><div id="subs" class="mono">‚Äî</div></div>
      <div class="card"><h3>üï∞ Wayback</h3><div id="wayback" class="mono">‚Äî</div></div>
      <div class="card"><h3>üìú robots.txt / sitemap.xml</h3><div id="robots" class="mono">‚Äî</div></div>
      <div class="card"><h3>üìÑ Page Peek (title/meta/links)</h3><div id="peek" class="mono">‚Äî</div></div>
    </div>

    <div class="footer small">
      Tips: press <span class="kbd">Enter</span> to run. Click chips above to open deep OSINT searches. Results are cached in memory,
      export JSON to save your session.
    </div>
  </div>

  <!-- libs for export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNa5lK4QWw0b0j2aVt3z2X2m5rS9Q7V5d8mVvQ+o3Qe1n2NQkG5l2gA5QzM8Vv4q8gZl0r1bU1yG7x4k3r3G0A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script>
  // ----------------- helpers -----------------
  const qs = sel => document.querySelector(sel);
  const qsa = sel => Array.from(document.querySelectorAll(sel));
  const sleep = ms => new Promise(r => setTimeout(r, ms));
  const fmt = x => (typeof x === 'object' ? JSON.stringify(x, null, 2) : String(x));
  const set = (id, val) => qs('#'+id).textContent = val;
  const append = (id, val) => qs('#'+id).textContent += val;

  function pct(n){ qs('#bar').style.width = Math.min(100, n) + '%'; }

  function templinks() {
    qsa('.chip').forEach(ch => {
      ch.onclick = () => {
        const d = qs('#domain').value.trim();
        const url = ch.dataset.open.replaceAll('{d}', encodeURIComponent(d));
        window.open(url, '_blank', 'noopener');
      };
    });
  }

  function saveJSON(obj, name='tangled-osint.json'){
    const blob = new Blob([JSON.stringify(obj, null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = name; a.click();
    URL.revokeObjectURL(url);
  }

  async function exportPNG(){
    const node = document.body;
    const canvas = await html2canvas(node, {backgroundColor:'#000'});
    const a = document.createElement('a');
    a.download = 'tangled-osint.png';
    a.href = canvas.toDataURL('image/png');
    a.click();
  }

  // ----------------- DNS over HTTPS -----------------
  async function doh(name, type='A'){
    const url = `https://dns.google/resolve?name=${encodeURIComponent(name)}&type=${encodeURIComponent(type)}`;
    const r = await fetch(url);
    if(!r.ok) throw new Error('DoH failed: '+type);
    return r.json();
  }

  function extractRR(json){
    const ans = json.Answer || [];
    return ans.map(a => a.data).filter(Boolean);
  }

  // ----------------- IP Geo -----------------
  async function ipGeo(ip){
    const r = await fetch(`https://ipwho.is/${encodeURIComponent(ip)}`);
    if(!r.ok) throw new Error('ipwho.is fail');
    return r.json();
  }

  // ----------------- Wayback -----------------
  async function waybackAvail(domain){
    const r = await fetch(`https://archive.org/wayback/available?url=${encodeURIComponent('http://'+domain)}`);
    return r.json();
  }
  async function waybackList(domain, limit=20){
    const r = await fetch(`https://web.archive.org/cdx/search/cdx?url=${encodeURIComponent('*.'+domain)}&output=json&fl=timestamp,original&filter=statuscode:200&limit=${limit}`);
    if(!r.ok) return [];
    const arr = await r.json();
    return (arr || []).slice(1).map(([ts,url]) => ({ts,url}));
  }

  // ----------------- robots/sitemap via CORS-friendly reader -----------------
  async function safeGet(url){
    // r.jina.ai fetches content as text only (no scripts), usually CORS-friendly
    const r = await fetch(`https://r.jina.ai/http://` + url.replace(/^https?:\/\//,''));
    if(!r.ok) throw new Error('fetch blocked');
    return r.text();
  }

  // ----------------- Page peek (title/meta/links) -----------------
  function parseTitleMeta(html){
    const t = (html.match(/<title[^>]*>([^<]*)<\/title>/i)||[])[1] || '';
    const metas = [...html.matchAll(/<meta\s+[^>]*name=["']?([^"'>\s]+)["']?[^>]*content=["']([^"']+)["']/gi)]
      .map(m => ({name:m[1],content:m[2]}));
    const links = [...html.matchAll(/<a\s+[^>]*href=["']([^"']+)["']/gi)].slice(0,50).map(m=>m[1]);
    return {title:t.trim(), metas, links};
  }

  // ----------------- subdomain wordlists -----------------
  const WORDLISTS = {
tiny: [
  "www","mail","api","dev","test","staging","blog","shop","cdn","img","static",
  "m","ftp","ns1","ns2","cp","admin","portal","sso","status","assets","docs",
  "help","support","events","beta","old","backup","mobile","news","media",
  "dashboard","user","login","signup","register","auth","id","oauth","accounts",
  "account","profile","app","apps","panel","secure","files","data","storage",
  "db","sql","mysql","pgsql","mongo","redis","cache","search","logs","reports",
  "monitor","grafana","metrics","alert","alerts","notify","notifs","tracker",
  "track","trace","audit","billing","invoice","payment","pay","checkout",
  "order","orders","cart","inventory","stock","products","product","catalog",
  "store","sales","crm","erp","hr","hrm","people","staff","jobs","career",
  "vacancies","apply","onboarding","training","edu","learn","class","classes",
  "students","teachers","exam","portal2","new","stage","next","v1","v2","v3",
  "internal","intra","intranet","ext","external","vpn","proxy","edge","gw",
  "gateway","fw","firewall","dmz","load","balancer","bal","ws","ws1","ws2",
  "node","node1","node2","cluster","k8s","kube","docker","container","ci",
  "cd","jenkins","git","gitlab","svn","repo","repos","source","code","devops",
  "ops","it","sys","sysadmin","root","linux","windows","mac","apple","android",
  "ios","cloud","azure","aws","gcp","digitalocean","linode","hetzner","ovh",
  "vm","vm1","vm2",
  "whois","rdns","dns","zone","records","names","who","dir","directory","ldap",
  "kerberos","ad","active","idm","idm2","samba","mail2","mx","smtp","imap",
  "pop","relay","antispam","filter","spam","virus","malware","scanner","scan",
  "proxy2","tor","onion","dark","shadow","ghost","stealth","hidden","secret",
  "vault","locker","crypt","crypto","key","keys","cert","ca","ssl","tls",
  "pki","trust","sign","sig","verify","auth2","saml","openid","idp","sp",
  "bridge","peer","p2p","sip","voip","pbx","phone","sms","mms","text","chat",
  "msg","im","xmpp","irc","slack","teams","zoom","meet","conf","conference",
  "video","stream","live","cdn2","edge2","edge3","media2","cdn3","cache2",
  "api2","api3","dev2","dev3","staging2","test2","old2","legacy","classic",
  "backup2","bkp","bak","arch","archive","history","logs2","log","log2"
],

small: [
  "www","mail","api","dev","test","staging","blog","shop","cdn","img","static","m","ftp","ns1","ns2","cp","admin","portal","sso","status","assets","docs","help","support","events","beta","old","backup","mobile",
  "app","apps","auth","gateway","edge","origin","office","intranet","jira","confluence","git","gitlab","grafana","prometheus","kibana","log","logs","ci","cd","jenkins","sonarqube","db","mysql","pgsql","mongo","redis","cache","queue","mq","kafka","stream","uploads","files","media","content","pay","billing","invoice","sandbox","demo","preview","preprod","prod","monitor","uptime","health","sentry","new","news","press","marketing","careers","status","api2","api3","dev1","dev2","dev3","qa","qa1","stage","stage1","vpn","gw","secure",
  "dashboard","console","panel","control","root","sys","system","config","settings","setup","admin2","admin3","root2",
  "idm","ldap","kerberos","ad","active","idm2","pki","ca","cert","certs","ssl","tls","crypto","key","keys","vault","locker","trust",
  "account","accounts","idp","saml","sso2","login","signin","signup","register","forgot","pwreset","password","auth2","auth3",
  "api4","api5","dev4","dev5","stage2","stage3","qa2","qa3","uat","uat1","uat2","canary","blue","green","deploy","release",
  "build","builds","pipeline","cicd","agent","runner","workers","node","node1","node2","node3","cluster","k8s","kube","docker","container","containers",
  "orchestration","swarm","mesos","nomad","terraform","ansible","chef","puppet","salt","helm",
  "pkg","package","packages","repo","repos","source","sources","code","codes","artifact","artifacts","registry","hub",
  "docs2","manual","handbook","wiki","kb","knowledge","howto","faq","guides","reference","spec","swagger","openapi",
  "static2","static3","assets2","assets3","img2","img3","cdn2","cdn3","edge2","edge3","origin2","origin3","res","resources","media2","media3",
  "files2","files3","upload","uploads2","dl","download","downloads","content2","content3","video","videos","stream2","stream3","audio","music",
  "backup2","backup3","bak","bkp","archives","archive","history","logs2","logs3","metrics","metric","alert","alerts","notify","notifs","status2","status3",
  "health2","health3","uptime2","uptime3","watch","watcher","observability","tracing","trace","apm","insight","insights","monitor2","monitor3",
  "payments","checkout","cart","order","orders","shop2","store","store2","catalog","stock","inventory","sales","crm","erp","hr","hrm","payroll","staff","people","team","teams","users","user",
  "profile","profiles","community","forum","forums","discuss","discussion","board","boards","comments","chat","chats","msg","messages","messaging","slack","teamsapp","zoom","meet","meeting","conf","conference",
  "test1","test2","test3","testing","tests","experiment","exp","try","trial","sample","example","examples","dummy","fake",
  "training","class","classes","students","teachers","learn","learning","edu","edu2","mooc","lms","exam","exams","quiz","quizzes","survey","surveys",
  "preview2","preview3","demo2","demo3","sandbox2","sandbox3","preprod2","prod2","prod3","production","internal","internal2","intra","intra2","external","external2",
  "legacy","classic","old2","old3","deprecated","sunset","retired","migration","migrate","upgrade","convert",
  "lab","labs","research","rnd","innovation","devops","ops","noc","soc","sec","siem","firewall","fw","waf","ids","ips","honeypot","threat","malware","virus","scan","scanner","security","cyber",
  "cloud","cloud2","aws","azure","gcp","digitalocean","do","linode","ovh","hetzner","vultr","ibm","oracle","vm","vm1","vm2","vm3","vsphere","esxi","hyperv",
  "proxy","proxy1","proxy2","tor","onion","hidden","dark","shadow","stealth","ghost","phantom",
  "edge4","edge5","cdn4","cdn5","gw2","gw3","gateway2","gateway3","fw2","fw3","vpn2","vpn3",
  "phone","phones","sip","voip","pbx","call","calls","sms","mms","text","chat2","chat3","bot","bots","ai","ml","dl","nlp","genai"
],
    
medium: [
  // Core business
  "account","accounts","user","users","customer","customers","client","clients","partner","partners",
  "vendor","vendors","supplier","suppliers","dealer","dealers","affiliate","affiliates","channel","channels",
  "crm","erp","sap","oracle","salesforce","netsuite","workday","servicenow","zendesk","freshdesk",

  // Finance / Payment
  "bank","banking","finance","financial","funds","funding","treasury","capital","equity","invest",
  "investor","investors","stocks","shares","securities","trading","forex","crypto","bitcoin","wallet",
  "blockchain","ico","nft","payu","stripe","paypal","adyen","square","klarna","payoneer","revolut",

  // Operations
  "ops","operations","workflow","process","supply","logistics","fulfillment","dispatch","warehouse",
  "inventory","stock","stocks","ship","shipping","delivery","track","tracking","trace","order","orders",
  "booking","reservations","reserve","reseller","wholesale","retail","ecommerce","checkout","cart",

  // Development
  "devportal","developer","developers","devops","opsportal","gitserver","scm","bitbucket","gitea",
  "source","repo","repos","repository","vcs","code","coding","commit","branch","merge","pull","pr",
  "cicd","ci-cd","pipeline","pipelines","build","builds","artifact","artifacts","pkg","packages",

  // Security
  "security","secure","secops","siem","ids","ips","firewall","waf","vpn1","vpn2","vpn3","vpn-gw",
  "vpn-ssl","vpn-tunnel","proxy","reverse-proxy","forward-proxy","guard","sentinel","cert","certs",
  "pki","ssl","tls","keys","keyserver","crypto","encryption","decrypt","forensics","incident","soc",

  // Monitoring / Analytics
  "monitoring","metrics","telemetry","tracing","dashboard","dashboards","insights","analytics",
  "bi","business-intel","bigdata","data","datascience","ml","ai","deeplearning","report","reports",
  "logging","logstash","elastic","es","splunk","datadog","newrelic","appdynamics","instana","nagios",
  "zabbix","icinga","observability","observed","perf","performance","load","stress","uptimecheck",

  // Cloud Infra
  "cloud","cloud1","cloud2","cloud3","aws","azure","gcp","alicloud","digitalocean","linode",
  "ovh","hetzner","rackspace","cloudflare","fastly","akamai","cdn1","cdn2","cdn3","objectstorage",
  "s3","buckets","bucket","blob","storage","fs","filesystem","nas","san","minio","backblaze","ipfs",

  // Communication
  "chat","chatbot","slack","teams","discord","irc","irc2","xmpp","meet","meetings","zoom",
  "call","calls","video","videochat","videocall","streaming","livestream","live","broadcast",
  "media1","media2","media3","podcast","radio","tv","channel","channels","sms","mms","push",

  // Testing
  "test1","test2","test3","testing","tests","qa2","qa3","uat","staging1","staging2","staging3",
  "experiment","experiments","lab","labs","research","rnd","innovation","proto","prototype","mock",
  "faker","simulation","sim","training","train","learn","education","academy","class","course",

  // HR / Internal
  "hr","people","talent","recruit","recruitment","hiring","jobs","job","career","careers",
  "payroll","salary","compensation","benefits","incentives","bonus","team","teams","intranet",
  "internal","staff","employee","employees","onboarding","offboarding","policies","compliance",

  // Customer Support
  "ticket","tickets","case","cases","issue","issues","faq","faqs","chat-support","chatbot-support",
  "helpdesk","service","services","portal-support","bug","bugs","bugtracker","support2","support3",

  // Products
  "product","products","sku","catalog","catalogue","collection","collections","launch","launchpad",
  "feature","features","roadmap","roadmaps","update","updates","release","releases","beta2","beta3",

  // Marketing
  "promo","promos","promotion","promotions","campaign","campaigns","ads","advertising","adserver",
  "newsletter","newsletters","lead","leads","crm2","crm3","influence","influencer","pr","presskit",
  "content1","content2","content3","landing","landingpage","seo","sem","growth","analytics2",

  // API & Integration
  "api-gateway","apigw","apiv1","apiv2","apiv3","openapi","swagger","graphql","rest","restapi",
  "soap","wsdl","rpc","endpoint","endpoints","callback","webhook","hooks","integration","sdk","cli",
  "cli-tools","toolkit","developer-tools","partners-api","partner-api","service-api","data-api",

  // Legacy / Migration
  "legacy","old1","old2","backup1","backup2","migrate","migration","converter","converter2",
  "archive","archives","deprecated","sunset","retired","unused","vault","vaults","cold","coldstore",

  // Extras
  "alpha","beta4","gamma","delta","epsilon","omega","extra","extras","bonus","hidden",
  "trial","trial1","trial2","offer","offers","deals","discount","discounts","gift","gifts",
  "special","specials","private","public","preview2","preview3","internal2","internal3"
]

  };

  // ----------------- Main scan -----------------
  let CANCEL = false;
  async function scan(){
    CANCEL = false;
    const domain = qs('#domain').value.trim();
    if(!domain) return alert('Enter a domain');
    const wordlist = WORDLISTS[qs('#wordlistSel').value];
    const limit = parseInt(qs('#limit').value) || 500;
    set('summary', 'Starting scan...');
    set('dns', '‚Äî'); set('geo', '‚Äî'); set('email', '‚Äî'); set('subs', '‚Äî');
    set('wayback', '‚Äî'); set('robots', '‚Äî'); set('peek', '‚Äî');
    pct(0);

    try {
      // DNS records
      const dnsA = await doh(domain, 'A');
      const dnsAAAA = await doh(domain, 'AAAA');
      const dnsMX = await doh(domain, 'MX');
      const dnsNS = await doh(domain, 'NS');
      const dnsTXT = await doh(domain, 'TXT');
      const ips = extractRR(dnsA).concat(extractRR(dnsAAAA));
      const mxs = extractRR(dnsMX);
      const nss = extractRR(dnsNS);
      const txts = extractRR(dnsTXT);
      set('dns', `A: ${ips.join(', ')}\nAAAA: ${extractRR(dnsAAAA).join(', ')}\nMX: ${mxs.join(', ')}\nNS: ${nss.join(', ')}\nTXT: ${txts.join(', ')}`);

      // Geo
      if(ips.length){
        const geo = await ipGeo(ips[0]);
        set('geo', `IP: ${geo.ip}\nCountry: ${geo.country} (${geo.country_code})\nRegion: ${geo.region}\nCity: ${geo.city}\nISP: ${geo.connection?.isp || '?'}\nOrg: ${geo.connection?.org || '?'}`);
      }

      // Email (SPF/DMARC)
      const spf = txts.find(t => t.includes('v=spf1'));
      const dmarc = await doh(`_dmarc.${domain}`, 'TXT').catch(() => ({}));
      const dmarcTxt = extractRR(dmarc).find(t => t.includes('v=DMARC1'));
      set('email', `SPF: ${spf || 'None'}\nDMARC: ${dmarcTxt || 'None'}`);

      // Subdomains
      let subs = [];
      for(let i=0; i<Math.min(wordlist.length, limit); i++){
        if(CANCEL) break;
        const sub = wordlist[i];
        pct((i / Math.min(wordlist.length, limit)) * 100);
        try {
          const res = await doh(`${sub}.${domain}`, 'A');
          if(res.Answer && res.Answer.length) subs.push(sub);
          append('subs', `${sub}.${domain}\n`);
        } catch(e){}
        await sleep(50);
      }
      set('subs', subs.map(s => `${s}.${domain}`).join('\n') || 'None found');

      // Wayback
      const wb = await waybackList(domain, 10);
      set('wayback', wb.map(x => `${x.ts}: ${x.url}`).join('\n') || 'None');

      // robots.txt / sitemap.xml
      try {
        const robots = await safeGet(`${domain}/robots.txt`);
        const sitemap = await safeGet(`${domain}/sitemap.xml`);
        set('robots', `robots.txt:\n${robots}\n\nsitemap.xml:\n${sitemap}`);
      } catch(e){ set('robots', 'Not found'); }

      // Page peek
      try {
        const html = await safeGet(`http://${domain}`);
        const {title, metas, links} = parseTitleMeta(html);
        set('peek', `Title: ${title}\n\nMeta:\n${metas.map(m => `${m.name}: ${m.content}`).join('\n')}\n\nLinks (first 50):\n${links.join('\n')}`);
      } catch(e){ set('peek', 'Failed to fetch'); }

      // Summary
      set('summary', `‚úÖ Scan complete for ${domain}\nIPs: ${ips.length}\nSubdomains: ${subs.length}\nMX: ${mxs.length}\nWayback: ${wb.length}`);
      pct(100);
    } catch(e){
      set('summary', `‚ùå Scan failed: ${e.message}`);
      console.error(e);
    }
  }

  // ----------------- Events -----------------
  qs('#scanBtn').onclick = scan;
  qs('#cancelBtn').onclick = () => { CANCEL = true; };
  qs('#exportImg').onclick = exportPNG;
  qs('#exportJson').onclick = () => {
    const domain = qs('#domain').value.trim();
    const data = {
      domain,
      dns: qs('#dns').textContent,
      geo: qs('#geo').textContent,
      email: qs('#email').textContent,
      subs: qs('#subs').textContent,
      wayback: qs('#wayback').textContent,
      robots: qs('#robots').textContent,
      peek: qs('#peek').textContent
    };
    saveJSON(data, `tangled-osint-${domain}.json`);
  };

  // Music toggle
  qs('#music-control').onclick = () => {
    const audio = qs('#bg-music');
    if (audio.paused) {
      audio.play();
      qs('#music-control').textContent = 'üîä';
    } else {
      audio.pause();
      qs('#music-control').textContent = 'üéµ';
    }
  };

  // Init
  templinks();
  qs('#domain').onkeydown = e => { if(e.key === 'Enter') scan(); };
  </script>
</body>
</html>