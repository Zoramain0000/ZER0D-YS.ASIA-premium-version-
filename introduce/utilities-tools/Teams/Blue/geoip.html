<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GeoIP Mapper</title>

<!-- Leaflet.js for maps -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
:root {
  --bg:#0a0a0f;
  --panel: rgba(20,20,30,0.85);
  --accent:#c58b00;
  --border: rgba(197,139,0,0.5);
  --text:#f5f5f5;
}

* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: "Segoe UI", system-ui, sans-serif; background: var(--bg); color: var(--text); }

video.bg-video {
  position: fixed; inset:0; width:100%; height:100%; object-fit: cover; filter: brightness(0.2); z-index:-2;
}

.container { max-width:1200px; margin:auto; padding:100px 20px 40px; }

h1 { text-align:center; color: var(--accent); margin-bottom:14px; }
.panel { background: var(--panel); border:1px solid var(--border); border-radius:16px; padding:20px; margin-bottom:20px; }
textarea { width:100%; min-height:100px; padding:12px; border-radius:10px; background:#0d0d0d; border:1px solid var(--border); color:#fff; font-family: monospace; resize:vertical; }

button { background:var(--accent); border:none; padding:10px 18px; border-radius:10px; color:#000; cursor:pointer; font-weight:700; margin-top:8px; }
button:hover { opacity:.85; }

#map { height:500px; border-radius:16px; margin-top:14px; }
.log { margin-top:12px; font-size:14px; max-height:180px; overflow-y:auto; background:#050505; border:1px solid var(--border); border-radius:10px; padding:10px; font-family: monospace; }
.log div { margin-bottom:6px; }
mark { background:#ffd27a; color:#000; font-weight:700; }
</style>
</head>

<body>

<video class="bg-video" autoplay muted loop playsinline>
  <source src="background/1761817527453041720p.mp4" type="video/mp4">
</video>

<div class="container">
  <h1>üåç GeoIP Mapping Tool</h1>

  <div class="panel">
    <textarea id="ipInput" placeholder="Enter IP addresses (comma or space separated)"></textarea>
    <button onclick="mapIPs()">Map IPs</button>
    <div class="log" id="log"></div>
  </div>

  <div id="map"></div>
</div>

<!-- Leaflet.js -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const map = L.map('map').setView([20,0], 2);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

const logDiv = document.getElementById("log");

async function fetchIPGeo(ip){
  try{
    const res = await fetch(`https://ipapi.co/${ip}/json/`);
    const data = await res.json();
    return data;
  } catch {
    return null;
  }
}

async function mapIPs(){
  const input = document.getElementById("ipInput").value.trim();
  if(!input) return alert("Enter at least one IP address.");
  const ips = input.split(/[\s,]+/).filter(Boolean);
  logDiv.innerHTML = "";

  ips.forEach(ip=>{
    const line = document.createElement("div");
    line.textContent = `Mapping ${ip}...`;
    logDiv.appendChild(line);
  });

  for(const ip of ips){
    const data = await fetchIPGeo(ip);
    const line = document.createElement("div");

    if(!data || data.error){
      line.innerHTML = `<mark>${ip}</mark> ‚Üí Failed to fetch data`;
      logDiv.appendChild(line);
      continue;
    }

    const { city, region, country_name, latitude, longitude, org } = data;
    line.innerHTML = `<mark>${ip}</mark> ‚Üí ${city || "-"}, ${region || "-"}, ${country_name || "-"} | ${org || "-"}`;
    logDiv.appendChild(line);

    if(latitude && longitude){
      L.marker([latitude, longitude]).addTo(map)
        .bindPopup(`<b>${ip}</b><br>${city||"-"}, ${region||"-"}, ${country_name||"-"}<br>${org||"-"}`);
    }
  }
}
</script>

</body>
</html>
