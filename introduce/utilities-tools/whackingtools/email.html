<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Email OSINT — Cloudflare DoH </title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    /* Explicit colors (no :root) */
    /* accent/gold */ 
    --accent-color: #c58b00;
    /* muted */ 
    --muted-color: #d7c38a;

    * { box-sizing: border-box; }
    html,body { height:100%; margin:0; font-family: "Segoe UI", system-ui, Arial, sans-serif; background:#000; color:#c58b00; }
    .bg-video {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -3;
      filter: brightness(.45);
    }
    .overlay {
      position: fixed;
      inset: 0;
      background: linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.65));
      z-index: -2;
    }
    .wrap {
      min-height: 100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 2rem;
    }
    .panel {
      width:100%;
      max-width:1200px;
      background: rgba(0,0,0,0.45);
      border:1px solid rgba(197,139,0,0.12);
      padding: 1.25rem;
      border-radius: 12px;
      backdrop-filter: blur(6px);
      position: relative;
      z-index: 1;
    }

    header { display:flex; gap:1rem; align-items:center; justify-content:space-between; }
    .title { display:flex; flex-direction:column; }
    h1 { margin:0; font-size:1.4rem; color:#c58b00; }
    p.lead { margin:6px 0 0; color:#d7c38a; font-size:0.95rem; }

    .controls { margin-top:1rem; display:flex; gap:0.5rem; flex-wrap:wrap; }
    input[type="text"], input[type="email"], textarea, select {
      width:100%;
      padding:10px;
      border-radius:8px;
      border:1px solid rgba(197,139,0,0.12);
      background: transparent;
      color: #c58b00;
      font-family: monospace;
      font-size:0.95rem;
    }
    .row { display:flex; gap:0.5rem; align-items:center; flex-wrap:wrap; margin-top:0.75rem; }
    .btn {
      background: transparent;
      border: 1px solid #c58b00;
      color: #c58b00;
      padding:10px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
    }
    .btn.primary { background: #c58b00; color: #070707; border:none; }
    .grid { display:grid; grid-template-columns: 1fr 420px; gap: 1rem; margin-top:1rem; }
    .card {
      padding:12px;
      border-radius:8px;
      background: rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.03);
      height:100%;
      overflow:auto;
    }
    pre { background:#071018; padding:12px; border-radius:8px; color:#d7c38a; overflow:auto; font-size:0.9rem; white-space:pre-wrap; word-break:break-word; }
    .badge { display:inline-block; padding:6px 8px; border-radius:6px; background: rgba(197,139,0,0.12); color:#c58b00; font-weight:600; margin-right:6px; }

    .suspicious { color:#ff7b7b; font-weight:700; }
    .meta { color:#d7c38a; font-size:0.95rem; margin-top:8px; }

    footer { margin-top:12px; color:#d7c38a; font-size:0.9rem; text-align:center; }

    .start-wrapper { text-align:center; }
    .start-btn {
      background: rgba(0,0,0,0.6);
      color: #c58b00;
      border: 1px solid #c58b00;
      padding: 14px 26px;
      border-radius: 10px;
      font-size:1.05rem;
      cursor:pointer;
    }
    .start-btn:hover { background:#c58b00; color:#070707; }

    .small { font-size:0.85rem; color:#d7c38a }

    .log { font-family: monospace; font-size:0.9rem; color:#d7c38a; margin:6px 0; }

    @media (max-width: 980px) {
      .grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <!-- keep original background video and music paths -->
  <video class="bg-video" autoplay loop muted playsinline>
    <source src="background/1761817527453041720p.mp4" type="video/mp4">
    Your browser does not support the background video.
  </video>

  <div class="overlay"></div>

  <audio id="bg-audio" loop>
    <source src="background/Programming___Coding___Hacking_music_vol.18__ANONYMOUS_HEADQUARTERS_(48k).mp3" type="audio/mpeg">
    Your browser does not support audio.
  </audio>

  <div class="start-wrapper" id="start-wrapper" style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:10;">
    <button class="start-btn" id="start-btn">Start Email OSINT</button>
  </div>

  <div class="wrap">
    <div class="panel" id="panel" style="display:none;">
      <header>
        <div class="title">
          <h1>Email OSINT — Cloudflare DoH (Frontend Only)</h1>
          <p class="lead">Client-side only. This tool uses Cloudflare DNS-over-HTTPS to perform automated multi-record DNS checks (TXT, MX, A, AAAA, CNAME, NS) and returns a live stream + final intelligence report.</p>
        </div>
        <div style="text-align:right;">
          <span class="badge">CLOUDFLARE</span>
          <div style="font-size:0.85rem;color:#d7c38a;margin-top:6px;">No API keys needed — all lookups use Cloudflare DoH (public endpoint)</div>
        </div>
      </header>

      <div class="controls">
        <div style="width:100%;display:flex;gap:8px;flex-wrap:wrap;">
          <input id="email-input" type="email" placeholder="target@example.com" />
          <button class="btn primary" id="analyze-btn">Analyze</button>
          <button class="btn" id="clear-btn">Clear</button>
          <button class="btn" id="copy-btn">Copy Summary</button>
          <button class="btn" id="export-btn">Export JSON</button>
        </div>

        <div class="row small" style="margin-top:6px;">
          <div>Tip: This tool performs DNS queries via Cloudflare's public DoH endpoint: <code>https://cloudflare-dns.com/dns-query?name={domain}&type={TYPE}</code></div>
        </div>
      </div>

      <div class="grid">
        <div class="card" style="min-height:320px;">
          <h3 style="color:#c58b00;margin-top:0">Live Console (progressive)</h3>
          <div id="results-area">
            <p style="color:#d7c38a">Live DNS activity and fetch logs will appear here.</p>
          </div>
        </div>

        <div class="card">
          <h3 style="color:#c58b00;margin-top:0">Final Intelligence Summary</h3>
          <div id="summary-area">
            <p style="color:#d7c38a">No summary yet.</p>
          </div>

          <div style="margin-top:12px;">
            <h4 style="color:#c58b00;margin:8px 0 6px;">What this checks</h4>
            <ul style="color:#d7c38a;line-height:1.5;">
              <li>Gravatar presence (public avatar)</li>
              <li>Disposable domain quick-check</li>
              <li>Cloudflare DoH lookups: TXT (SPF/DMARC), MX, A, AAAA, CNAME, NS</li>
              <li>Aggregates results into an actionable report</li>
            </ul>
          </div>
        </div>
      </div>

      <footer>
        Email OSINT — Cloudflare DoH • All requests originate from your browser to Cloudflare. Use responsibly.
      </footer>
    </div>
  </div>

  <script>
    // Minimal MD5 for Gravatar
    function md5(s){
      function rotl(n,c){return (n<<c)|(n>>>(32-c));}
      function toHex(i){return ('00000000'+(i>>>0).toString(16)).slice(-8);} 
      function cmn(q,a,b,x,s,t){a=(((a+q)|0)+(x+t)|0);return (((a<<s)|(a>>>(32-s)))+b)|0}
      function ff(a,b,c,d,x,s,t){return cmn((b&c)|((~b)&d),a,b,x,s,t)}
      function gg(a,b,c,d,x,s,t){return cmn((b&d)|(c&(~d)),a,b,x,s,t)}
      function hh(a,b,c,d,x,s,t){return cmn(b^c^d,a,b,x,s,t)}
      function ii(a,b,c,d,x,s,t){return cmn(c^(b|(~d)),a,b,x,s,t)}
      var bytes=[]; for(var i=0;i<s.length;i++) bytes.push(s.charCodeAt(i));
      var bitLen=bytes.length*8; bytes.push(0x80);
      while((bytes.length%64)!=56) bytes.push(0);
      for(var i=0;i<8;i++) bytes.push(bitLen & 255, bitLen>>8 & 255, bitLen>>16 & 255, bitLen>>24 & 255);
      var w=new Array(16), a=1732584193, b=-271733879, c=-1732584194, d=271733878;
      for(i=0;i<bytes.length;i+=64){
        for(var j=0;j<16;j++){
          w[j]=bytes[i+j*4] | (bytes[i+j*4+1]<<8) | (bytes[i+j*4+2]<<16) | (bytes[i+j*4+3]<<24);
        }
        var aa=a,bb=b,cc=c,dd=d;
        a=ff(a,b,c,d,w[0],7,-680876936); d=ff(d,a,b,c,w[1],12,-389564586); c=ff(c,d,a,b,w[2],17,606105819); b=ff(b,c,d,a,w[3],22,-1044525330);
        a=ff(a,b,c,d,w[4],7,-176418897); d=ff(d,a,b,c,w[5],12,1200080426); c=ff(c,d,a,b,w[6],17,-1473231341); b=ff(b,c,d,a,w[7],22,-45705983);
        a=ff(a,b,c,d,w[8],7,1770035416); d=ff(d,a,b,c,w[9],12,-1958414417); c=ff(c,d,a,b,w[10],17,-42063); b=ff(b,c,d,a,w[11],22,-1990404162);
        a=ff(a,b,c,d,w[12],7,1804603682); d=ff(d,a,b,c,w[13],12,-40341101); c=ff(c,d,a,b,w[14],17,-1502002290); b=ff(b,c,d,a,w[15],22,1236535329);
        a=gg(a,b,c,d,w[1],5,-165796510); d=gg(d,a,b,c,w[6],9,-1069501632); c=gg(c,d,a,b,w[11],14,643717713); b=gg(b,c,d,a,w[0],20,-373897302);
        a=gg(a,b,c,d,w[5],5,-701558691); d=gg(d,a,b,c,w[10],9,38016083); c=gg(c,d,a,b,w[15],14,-660478335); b=gg(b,c,d,a,w[4],20,-405537848);
        a=gg(a,b,c,d,w[9],5,568446438); d=gg(d,a,b,c,w[14],9,-1019803690); c=gg(c,d,a,b,w[3],14,-187363961); b=gg(b,c,d,a,w[8],20,1163531501);
        a=hh(a,b,c,d,w[11],4,-1444681467); d=hh(d,a,b,c,w[14],11,-51403784); c=hh(c,d,a,b,w[1],16,1735328473); b=hh(b,c,d,a,w[4],23,-1926607734);
        a=hh(a,b,c,d,w[7],4,-378558); d=hh(d,a,b,c,w[10],11,-2022574463); c=hh(c,d,a,b,w[13],16,1839030562); b=hh(b,c,d,a,w[0],23,-35309556);
        a=hh(a,b,c,d,w[3],4,-1530992060); d=hh(d,a,b,c,w[6],11,1272893353); c=hh(c,d,a,b,w[9],16,-155497632); b=hh(b,c,d,a,w[12],23,-1094730640);
        a=ii(a,b,c,d,w[15],6,681279174); d=ii(d,a,b,c,w[2],10,-358537222); c=ii(c,d,a,b,w[5],15,-722521979); b=ii(b,c,d,a,w[8],21,76029189);
        a=ii(a,b,c,d,w[11],6,-640364487); d=ii(d,a,b,c,w[14],10,-421815835); c=ii(c,d,a,b,w[1],15,530742520); b=ii(b,c,d,a,w[4],21,-995338651);
        a=ii(a,b,c,d,w[7],6,-198630844); d=ii(d,a,b,c,w[10],10,1126891415); c=ii(c,d,a,b,w[13],15,-1416354905); b=ii(b,c,d,a,w[0],21,-57434055);
        a=ii(a,b,c,d,w[3],6,1700485571); d=ii(d,a,b,c,w[6],10,-1894986606); c=ii(c,d,a,b,w[9],15,-1051523); b=ii(b,c,d,a,w[12],21,-2054922799);
        a=(a+aa)|0; b=(b+bb)|0; c=(c+cc)|0; d=(d+dd)|0;
      }
      return toHex(a)+toHex(b)+toHex(c)+toHex(d);
    }

    // UI bindings
    const startBtn = document.getElementById('start-btn');
    const startWrapper = document.getElementById('start-wrapper');
    const panel = document.getElementById('panel');
    const bgAudio = document.getElementById('bg-audio');

    startBtn.addEventListener('click', () => {
      bgAudio.play().catch(()=>{});
      panel.style.display = 'block';
      startWrapper.style.display = 'none';
    });

    const analyzeBtn = document.getElementById('analyze-btn');
    const clearBtn = document.getElementById('clear-btn');
    const copyBtn = document.getElementById('copy-btn');
    const exportBtn = document.getElementById('export-btn');
    const resultsArea = document.getElementById('results-area');
    const summaryArea = document.getElementById('summary-area');

    let lastResults = null;

    function logLive(msg){
      const div = document.createElement('div');
      div.className = 'log';
      div.textContent = (new Date()).toISOString().split('T')[1].split('Z')[0] + '  ' + msg;
      resultsArea.appendChild(div);
      resultsArea.scrollTop = resultsArea.scrollHeight;
    }

    function escapeHtml(str){ if (!str && str !== 0) return ''; return String(str).replace(/[&<>]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;'}[c])); }

    function simpleEmailCheck(email){
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    function isDisposableDomain(domain){
      const disposables = ['mailinator.com','10minutemail.com','guerrillamail.com','trashmail.com','tempmail.com','tempmail.net','dispostable.com'];
      return disposables.includes(domain.toLowerCase());
    }

    async function dohQuery(domain, type){
      const url = `https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(domain)}&type=${type}`;
      try{
        const res = await fetch(url, { headers: { 'Accept': 'application/dns-json' } });
        if (!res.ok) return { error: `HTTP ${res.status}` };
        const json = await res.json();
        return json;
      }catch(e){
        return { error: e.message };
      }
    }

    analyzeBtn.addEventListener('click', async ()=>{
      const email = (document.getElementById('email-input').value || '').trim();
      if (!email){ resultsArea.innerHTML = '<p style="color:#ffb86b">Enter an email first.</p>'; return; }
      if (!simpleEmailCheck(email)) { resultsArea.innerHTML = '<p style="color:#ff7b7b">Email format invalid.</p>'; return; }

      // reset
      resultsArea.innerHTML = '';
      summaryArea.innerHTML = '<p style="color:#d7c38a">Collecting data...</p>';
      lastResults = null;

      const domain = email.split('@')[1].toLowerCase();
      const gravatarHash = md5(email.trim().toLowerCase());
      const gravatarUrl = `https://www.gravatar.com/avatar/${gravatarHash}?d=404&s=200`;

      const result = { email, domain, disposable: isDisposableDomain(domain), gravatarFound: false, gravatarUrl, doh: {} };

      logLive(`Starting Cloudflare DoH scan for domain: ${domain}`);

      // check gravatar
      logLive('Checking Gravatar...');
      try{
        const g = await fetch(gravatarUrl, { method: 'HEAD' });
        result.gravatarFound = g.status === 200;
        logLive(result.gravatarFound ? 'Gravatar: FOUND' : 'Gravatar: not found');
      }catch(e){ logLive('Gravatar: lookup failed ('+e.message+')'); }

      // Define record types order for progressive scan
      const types = ['TXT','MX','A','AAAA','CNAME','NS'];
      for (const t of types){
        logLive(`Querying ${t} records via Cloudflare DoH...`);
        const r = await dohQuery(domain, t);
        result.doh[t] = r;
        if (r && !r.error){
          if (r.Answer && r.Answer.length){
            logLive(`${t} -> ${r.Answer.map(a=>a.data).join(' | ')}`);
          } else if (r.Answer === undefined && r.Answers === undefined && r.Answer == null && r.Status!==undefined && r.Status!==0){
            logLive(`${t} -> no answers (status ${r.Status})`);
          } else {
            // some servers return no Answer but Authority/Answer arrays empty
            logLive(`${t} -> no answers`);
          }
        } else {
          logLive(`${t} -> error: ${r && r.error ? r.error : 'unknown'}`);
        }
        // small pause so live output feels progressive (non-blocking friendly)
        await new Promise(res=>setTimeout(res, 250));
      }

      // Post-process SPF/TXT detection
      let txtAnswers = (result.doh['TXT'] && result.doh['TXT'].Answer) ? result.doh['TXT'].Answer.map(a=>a.data) : [];
      const spf = txtAnswers.filter(t=>/v=spf1/i.test(t));
      const dmarc = txtAnswers.filter(t=>/_dmarc|v=DMARC/i.test(t));

      // Build final summary
      const summaryLines = [];
      summaryLines.push(`<strong>Email</strong>: ${escapeHtml(email)}`);
      summaryLines.push(`<strong>Domain</strong>: ${escapeHtml(domain)}`);
      summaryLines.push(`<strong>Disposable</strong>: ${result.disposable ? '<span class="suspicious">Likely disposable</span>' : 'No'}`);
      summaryLines.push(`<strong>Gravatar</strong>: ${result.gravatarFound ? 'Found (avatar) — may be in use' : 'No avatar found'}`);
      summaryLines.push(`<strong>TXT records</strong>: ${txtAnswers.length ? '<pre style="white-space:pre-wrap; background:#000; padding:8px; border-radius:6px; color:#d7c38a">'+escapeHtml(txtAnswers.join('\n'))+'</pre>' : 'None'}`);
      summaryLines.push(`<strong>SPF</strong>: ${spf.length ? '<pre style="white-space:pre-wrap; background:#000; padding:8px; border-radius:6px; color:#d7c38a">'+escapeHtml(spf.join('\n'))+'</pre>' : 'Not found'}`);
      summaryLines.push(`<strong>DMARC</strong>: ${dmarc.length ? '<pre style="white-space:pre-wrap; background:#000; padding:8px; border-radius:6px; color:#d7c38a">'+escapeHtml(dmarc.join('\n'))+'</pre>' : 'Not found'}`);

      // MX / A / AAAA / CNAME / NS
      const mx = (result.doh['MX'] && result.doh['MX'].Answer) ? result.doh['MX'].Answer.map(a=>a.data) : [];
      const a = (result.doh['A'] && result.doh['A'].Answer) ? result.doh['A'].Answer.map(a=>a.data) : [];
      const aaaa = (result.doh['AAAA'] && result.doh['AAAA'].Answer) ? result.doh['AAAA'].Answer.map(a=>a.data) : [];
      const cname = (result.doh['CNAME'] && result.doh['CNAME'].Answer) ? result.doh['CNAME'].Answer.map(a=>a.data) : [];
      const ns = (result.doh['NS'] && result.doh['NS'].Answer) ? result.doh['NS'].Answer.map(a=>a.data) : [];

      summaryLines.push(`<strong>MX</strong>: ${mx.length ? '<pre style="white-space:pre-wrap; background:#000; padding:8px; border-radius:6px; color:#d7c38a">'+escapeHtml(mx.join('\n'))+'</pre>' : 'None found'}`);
      summaryLines.push(`<strong>A</strong>: ${a.length ? escapeHtml(a.join(', ')) : 'None'}`);
      summaryLines.push(`<strong>AAAA</strong>: ${aaaa.length ? escapeHtml(aaaa.join(', ')) : 'None'}`);
      summaryLines.push(`<strong>CNAME</strong>: ${cname.length ? escapeHtml(cname.join('\n')) : 'None'}`);
      summaryLines.push(`<strong>NS</strong>: ${ns.length ? '<pre style="white-space:pre-wrap; background:#000; padding:8px; border-radius:6px; color:#d7c38a">'+escapeHtml(ns.join('\n'))+'</pre>' : 'None'}`);

      // finalize
      summaryArea.innerHTML = summaryLines.join('<br><br>');

      // also show a compact JSON dump in results for export / copy
      lastResults = { email, domain, disposable: result.disposable, gravatarFound: result.gravatarFound, doh: result.doh };
      const dump = document.createElement('pre');
      dump.style.marginTop = '12px';
      dump.textContent = JSON.stringify(lastResults, null, 2);
      resultsArea.appendChild(dump);
      resultsArea.scrollTop = resultsArea.scrollHeight;

      logLive('Scan complete — summary generated.');
    });

    clearBtn.addEventListener('click', ()=>{
      document.getElementById('email-input').value = '';
      resultsArea.innerHTML = '<p style="color:#d7c38a">Live DNS activity and fetch logs will appear here.</p>';
      summaryArea.innerHTML = '<p style="color:#d7c38a">No summary yet.</p>';
      lastResults = null;
    });

    copyBtn.addEventListener('click', async ()=>{
      if (!lastResults) { alert('No results to copy.'); return; }
      try{ await navigator.clipboard.writeText(JSON.stringify(lastResults, null, 2)); alert('Summary copied to clipboard.'); }catch(e){ alert('Copy failed: '+e.message); }
    });

    exportBtn.addEventListener('click', ()=>{
      if (!lastResults) { alert('No results to export.'); return; }
      const blob = new Blob([JSON.stringify(lastResults, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'email-osint-cloudflare.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    // Allow Ctrl+Enter to analyze
    document.addEventListener('keydown', (e)=>{ if ((e.ctrlKey||e.metaKey) && e.key === 'Enter'){
      const panelVisible = document.getElementById('panel').style.display !== 'none'; if (panelVisible) document.getElementById('analyze-btn').click();
    }});
  </script>
</body>
</html>
